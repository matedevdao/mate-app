{"version":3,"file":"chat-rooms.js","sourceRoot":"","sources":["../../src/components/chat-rooms.ts"],"names":[],"mappings":"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","sourcesContent":["import { tokenManager } from '@gaiaprotocol/client-common';\nimport { el } from '@webtaku/el';\nimport Navigo from 'navigo';\nimport { zeroAddress } from 'viem';\nimport { fetchNftOwnershipStats } from '../api/nft-ownership-stats';\nimport babypingAvatar from './chat-rooms-avatars/babyping.png';\nimport bmcsAvatar from './chat-rooms-avatars/bmcs.png';\nimport emateAvatar from './chat-rooms-avatars/emate.png';\nimport kcdKongzAvatar from './chat-rooms-avatars/kcd-kongz.png';\nimport mateAvatar from './chat-rooms-avatars/mate.png';\nimport sparrowAvatar from './chat-rooms-avatars/sparrow.png';\nimport { Component } from './component';\n\nfunction createChatRooms(router: Navigo): Component {\n  const list = el('ion-content', { className: 'chat-rooms' });\n\n  const nfts = [\n    {\n      ids: ['dogesoundclub-mates', 'dogesoundclub-e-mates', 'dogesoundclub-biased-mates'],\n      roomId: 'mates',\n      name: '메이트 홀더 모임',\n      avatars: [mateAvatar, emateAvatar, bmcsAvatar],\n      lastMessage: '',\n      lastMessageTime: '',\n      purchaseUrls: [\n        { name: 'OpenSea', url: 'https://opensea.io/mate' },\n        { name: 'Magic Eden', url: 'https://magiceden.io/mate' },\n        { name: 'X2Y2', url: 'https://x2y2.io/mate' },\n      ],\n    },\n    {\n      ids: ['sigor-sparrows'],\n      roomId: 'sigor-sparrows',\n      name: '시고르 참새 홀더 모임',\n      avatars: [sparrowAvatar],\n      lastMessage: '',\n      lastMessageTime: '',\n      purchaseUrls: [\n        { name: 'OpenSea', url: 'https://opensea.io/sparrow' },\n      ],\n    },\n    {\n      ids: ['kingcrowndao-kongz'],\n      roomId: 'kcd-kongz',\n      name: 'KCD 콩즈 홀더 모임',\n      avatars: [kcdKongzAvatar],\n      lastMessage: '방금 들어왔습니다!',\n      lastMessageTime: '2025-07-22 14:30',\n      purchaseUrls: [\n        { name: 'OpenSea', url: 'https://opensea.io/babyping' },\n      ],\n    },\n    {\n      ids: ['babyping'],\n      roomId: 'babyping',\n      name: '베이비핑 홀더 모임',\n      avatars: [babypingAvatar],\n      lastMessage: '',\n      lastMessageTime: '',\n      purchaseUrls: [\n        { name: 'OpenSea', url: 'https://opensea.io/babyping' },\n      ],\n    }\n  ];\n\n  const buttons: HTMLIonButtonElement[] = []; // 각 버튼을 담아둡니다\n\n  for (const nft of nfts) {\n    const card = el('ion-card', {\n      style: { textAlign: 'center', padding: '12px' }\n    });\n\n    const header = el('ion-card-header',\n      el('ion-card-title', {\n        style: {\n          fontSize: '18px',\n          fontWeight: '600',\n          margin: '0',\n        }\n      }, nft.name)\n    );\n\n    header.style.justifyContent = 'center';\n    header.style.display = 'flex';\n\n    const content = el('ion-card-content', {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginTop: '8px',\n        position: 'relative',\n        minHeight: '60px',\n      }\n    });\n\n    if (nft.avatars.length > 1) {\n      const overlap = 52;\n\n      nft.avatars.forEach((avatar, index) => {\n        const avatarEl = el('ion-avatar', {\n          style: {\n            width: '60px',\n            height: '60px',\n            position: 'absolute',\n            left: `calc(50% + ${(index - (nft.avatars.length - 1) / 2) * overlap}px)`,\n            top: '0',\n            transform: 'translateX(-50%)',\n            zIndex: `${index}`\n          }\n        },\n          el('img', { src: avatar, alt: nft.name })\n        );\n        content.appendChild(avatarEl);\n      });\n    } else {\n      const avatarEl = el('ion-avatar', {\n        style: {\n          width: '60px',\n          height: '60px',\n          margin: '0 auto',\n        }\n      },\n        el('img', { src: nft.avatars[0], alt: nft.name })\n      );\n      content.appendChild(avatarEl);\n    }\n\n    const infoSection = el('div', {\n      style: {\n        marginTop: '16px',\n        textAlign: 'center',\n        fontSize: '14px',\n        lineHeight: '1.4',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '4px',\n      }\n    });\n\n    const holderInfo = el('div', `홀더 …명`);\n    infoSection.appendChild(holderInfo);\n\n    const button = el('ion-button', {\n      style: { marginTop: '8px' },\n      expand: 'block',\n      disabled: true,\n    }, el('ion-spinner', { name: 'circular' }));\n    buttons.push(button);\n\n    card.appendChild(header);\n    card.appendChild(content);\n    card.appendChild(infoSection);\n    card.appendChild(button);\n    list.appendChild(card);\n  }\n\n  const address = tokenManager.getAddress() ?? zeroAddress;\n\n  fetchNftOwnershipStats(address).then(result => {\n    nfts.forEach((nft, idx) => {\n      const btn = buttons[idx];\n      const canAccess = nft.ids.some(id => result[id]?.owned);\n      const totalHolders = nft.ids.reduce((acc, id) => {\n        if (result[id]?.totalHolders) {\n          return acc + result[id].totalHolders;\n        }\n        return acc;\n      }, 0);\n\n      const holderInfo = btn.parentElement?.querySelector<HTMLDivElement>('div');\n      if (holderInfo) holderInfo.textContent = `홀더 ${totalHolders}명`;\n\n      btn.textContent = canAccess ? '입장하기' : 'NFT 구매하기';\n      btn.color = canAccess ? 'primary' : 'secondary';\n      btn.disabled = false;\n\n      if (canAccess) {\n        btn.onclick = () => router.navigate(`/${nft.roomId}`);\n      } else {\n        btn.onclick = () => {\n          alert('구매 기능은 준비 중입니다.');\n          return;\n\n          if (!nft.purchaseUrls?.length) {\n            alert('구매 가능한 경로가 없습니다.');\n            return;\n          }\n          const sheet = el('ion-action-sheet');\n          sheet.header = `${nft.name} 구매처 선택`;\n          sheet.buttons = [\n            ...nft.purchaseUrls.map(p => ({\n              text: p.name,\n              handler: () => { window.open(p.url, '_blank') }\n            })),\n            { text: '취소', role: 'cancel' }\n          ];\n          document.body.appendChild(sheet);\n          sheet.present();\n        };\n      }\n    });\n  }).catch(err => {\n    console.error(err);\n    buttons.forEach(btn => {\n      btn.textContent = '오류 발생';\n      btn.color = 'danger';\n    });\n  });\n\n  return {\n    el: list,\n    remove() {\n      list.remove();\n    }\n  };\n}\n\nexport { createChatRooms };\n"]}